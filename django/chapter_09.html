<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
  <title>Django | Chapter 9: Pages app</title>
  <meta name="description" content="Learn how to develop and deploy real, production-level web applications with Python and Django. And explore Django Rest Framework for building modern web APIs.">
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i" rel="stylesheet">
  <link rel="stylesheet" href="../static/css/main.css">
  <link rel="canonical" href="https://djangoforbeginners.com/">
</head>
<body class="site">
  <header class="header-home">
    <div class="container-flex">
        <h1 class="h1-home">Django 2.0 Tutorial for Beginners</h1>

    </div>
  </header>
  <main class="site-content">
    <div class="container-flex">
      <article class="post">

  <div class="post-header">
    <h1 class="post-title" itemprop="name headline">Chapter 9: Pages app</h1>
    <p class="post-meta">
      Add styling with Bootstrap and a new Pages app.</p>
  </div>

  <div class="post-content" itemprop="articleBody">
    <p>We want our <em>social messaging</em> app to look good so in this chapter we will add a dedicated <em>pages app</em> for our static pages and use <a href="https://getbootstrap.com/">Bootstrap</a> to style everything.</p>

<p>Bootstrap is the most popular framework for building responsive, mobile-first projects. Rather than write all our own CSS and JavaScript for common website layout features, we can instead rely on Bootstrap to do the heavy lifting. This means with only a small amount of code on our part we can quickly have great looking websites. And if we want to make custom changes as a project progresses, it’s easy to override Bootstrap where needed, too.</p>

<p>When you want to focus on the functionality of a project and not the design, Bootstrap is a great choice. That’s why we’ll use it here.</p>

<p>Complete source code for this chapter can be found <a href="https://github.com/wsvincent/djangoforbeginners/tree/master/ch9-pages-app" target="\_blank">on Github</a>.</p>

<h2 id="pages-app">Pages app</h2>
<p>In the previous chapter we displayed our homepage by including view logic in our <code class="highlighter-rouge">urls.py</code> file. While this approach works, it feels somewhat hackish to me and it certainly doesn’t scale with more pages over time. Instead we can create a dedicated <code class="highlighter-rouge">pages</code> app for all our static pages. This will keep our code nice and organized going forward.</p>

<p>On the command line use the <code class="highlighter-rouge">startapp</code> command to make our new app.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>(msg) $ ./manage.py startapp pages
</code></pre>
</div>

<p>Then immediately update our <code class="highlighter-rouge">settings.py</code> file. I often forget to do this so it’s a good practice to just immediately add new apps to the <code class="highlighter-rouge">settings.py</code> file whenever you create them.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># msg_project/settings.py</span>
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">'django.contrib.admin'</span><span class="p">,</span>
    <span class="s">'django.contrib.auth'</span><span class="p">,</span>
    <span class="s">'django.contrib.contenttypes'</span><span class="p">,</span>
    <span class="s">'django.contrib.sessions'</span><span class="p">,</span>
    <span class="s">'django.contrib.messages'</span><span class="p">,</span>
    <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
    <span class="s">'users'</span><span class="p">,</span>
    <span class="s">'pages'</span><span class="p">,</span>
<span class="p">]</span>
</code></pre>
</div>

<p>Now we can update our project-level <code class="highlighter-rouge">urls.py</code> file. Go ahead and remove the import of <code class="highlighter-rouge">TemplateView</code>. We will also update the <code class="highlighter-rouge">''</code> route to include the <code class="highlighter-rouge">pages</code> app.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># msg_project/urls.py</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span><span class="p">,</span> <span class="n">include</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'pages.urls'</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'admin/'</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'users/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'users.urls'</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'users/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'django.contrib.auth.urls'</span><span class="p">)),</span>
<span class="p">]</span>
</code></pre>
</div>

<p>It’s time to add our homepage and about page which means Django’s standard urls/views/templates dance. We’ll start with the <code class="highlighter-rouge">pages/urls.py</code> file. First create it.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>(msg) $ touch pages/urls.py
</code></pre>
</div>

<p>Then import our not-yet-created views, set the route paths, and make sure to name each url, too.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># pages/urls.py</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">HomePageView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">'home'</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'about/'</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">AboutPageView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">'about'</span><span class="p">),</span>
<span class="p">]</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge">views.py</code> code should look familiar at this point. We’re using Django’s <code class="highlighter-rouge">TemplateView</code> generic class-based view which means we only need to specify our <code class="highlighter-rouge">template_name</code> to use it.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># pages/views.py</span>
<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="kn">import</span> <span class="n">TemplateView</span>


<span class="k">class</span> <span class="nc">HomePageView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s">'home.html'</span>


<span class="k">class</span> <span class="nc">AboutPageView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s">'about.html'</span>
</code></pre>
</div>

<p>We already have a <code class="highlighter-rouge">home.html</code> template so only the <code class="highlighter-rouge">about.html</code> file needs to be created.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>(msg) $ touch templates/about.html
</code></pre>
</div>

<p>This file will extend our base template and simply say “About page.” for now.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- templates/about.html --&gt;</span>
{% extends 'base.html' %}

{% block content %}
<span class="nt">&lt;h1&gt;</span>About page.<span class="nt">&lt;/h1&gt;</span>
{% endblock %}
</code></pre>
</div>

<p>If you navigate to the About page at <a href="http://127.0.0.1:8000/about/">http://127.0.0.1:8000/about/</a> the new page is now visible.</p>

<p><img src="https://djangoforbeginners.com/assets/images/book/pages-app/about.png" alt="About page" /></p>

<p>The homepage template remains unchanged though we’ve updated its url and view. Navigate to the homepage at <a href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a> to confirm it remains unchanged.</p>

<p><img src="https://djangoforbeginners.com/assets/images/book/pages-app/home_newuser.png" alt="Homepage with new user" /></p>

<h2 id="tests">Tests</h2>
<p>We’ve added new code and functionality which means it’s time for tests. You can never have enough tests in your projects. Even though they take some upfront time to write, they always save you time down the road and give confidence as a project grows in complexity.</p>

<p>There are two ideal times to add tests: either before you write any code (test-driven-development) or immediately after you’ve added new functionality and it’s clear in your mind.</p>

<p>Currently our project has five pages:</p>

<ul>
  <li>home</li>
  <li>about</li>
  <li>signup</li>
  <li>login</li>
  <li>logout</li>
</ul>

<p>However we only need to test the first three. Login and logout are part of Django and rely on internal views and url routes. They therefore already have test coverage. If we made substantial changes to them in the future, we <em>would</em> want to add tests for that. But as a general rule, you do not need to add tests for core Django functionality.</p>

<p>Since we have urls, templates, and views for each of our three new pages we’ll add tests for each. And as we’re not yet using a database yet, Django’s <a href="https://docs.djangoproject.com/en/2.0/topics/testing/tools/#simpletestcase">SimpleTestCase</a> will suffice for our needs.</p>

<p>Here’s what the code should look like in your <code class="highlighter-rouge">pages/tests.py</code> file.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># pages/tests.py</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">SimpleTestCase</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse</span>


<span class="k">class</span> <span class="nc">HomePageTests</span><span class="p">(</span><span class="n">SimpleTestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_home_page_status_code</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_url_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'home'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_uses_correct_template</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'home'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTemplateUsed</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">'home.html'</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">AboutPageTests</span><span class="p">(</span><span class="n">SimpleTestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_about_page_status_code</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/about/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_url_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'about'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_uses_correct_template</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'about'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTemplateUsed</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">'about.html'</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">SignupPageTests</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="n">username</span> <span class="o">=</span> <span class="s">'newuser'</span>
    <span class="n">email</span> <span class="o">=</span> <span class="s">'<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2b454e5c5e584e596b4e464a424705484446">[email&#160;protected]</a>'</span>

    <span class="k">def</span> <span class="nf">test_signup_page_status_code</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/users/signup/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_url_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'signup'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_view_uses_correct_template</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">'signup'</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTemplateUsed</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">'signup.html'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_signup_form</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_user</span> <span class="o">=</span> <span class="n">get_user_model</span><span class="p">()</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">email</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_user_model</span><span class="p">()</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_user_model</span><span class="p">()</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>
                         <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_user_model</span><span class="p">()</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>
                         <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">email</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">email</span><span class="p">)</span>
</code></pre>
</div>

<p>For each page we’re testing three things:</p>

<ul>
  <li>the page exists and returns a HTTP 200 status code</li>
  <li>the page uses the correct url name in the view</li>
  <li>the proper template is being used</li>
</ul>

<p>Our signup page also has a form so we should test that, too. In the test <code class="highlighter-rouge">test_signup_form</code> we’re verifying that when a username and email address are POSTed (sent to the database), they match what is stored on the <code class="highlighter-rouge">CustomUser</code> model.</p>

<p>Run our tests to confirm everything passes.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>(msg) $ ./manage.py test
</code></pre>
</div>

<h2 id="bootstrap">Bootstrap</h2>
<p>If you’ve never used Bootstrap before you’re in for a real treat. It accomplishes so much in so little code.</p>

<p>There are two ways to add Bootstrap to a project: you can download all the files and serve them yourself or rely on a Content Delivery Network (CDN). The second approach is simpler to implement so that’s what we’ll use here.</p>

<p><a href="https://getbootstrap.com/docs/4.0/getting-started/introduction/">Bootstrap comes with a starter template</a> that includes the basic files needed. Notably there are four that we incorporate:</p>

<ul>
  <li><code class="highlighter-rouge">Bootstrap.css</code></li>
  <li><code class="highlighter-rouge">jQuery.js</code></li>
  <li><code class="highlighter-rouge">Popper.js</code></li>
  <li><code class="highlighter-rouge">Bootstrap.js</code></li>
</ul>

<p>Here’s what the updated <code class="highlighter-rouge">base.html</code> file should look like. Generally you should type all code examples yourself but as this is one is quite long, it’s ok to copy and paste here.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- templates/base.html --&gt;</span>
<span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="c">&lt;!-- Required meta tags --&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1, shrink-to-fit=no"</span><span class="nt">&gt;</span>

    <span class="c">&lt;!-- Bootstrap CSS --&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"</span> <span class="na">integrity=</span><span class="s">"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;title&gt;</span>Hello, world!<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Hello, world!<span class="nt">&lt;/h1&gt;</span>

    <span class="c">&lt;!-- Optional JavaScript --&gt;</span>
    <span class="c">&lt;!-- jQuery first, then Popper.js, then Bootstrap JS --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://code.jquery.com/jquery-3.2.1.slim.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
</div>

<p>Let’s add a navigation bar at the top of the page which contains all our links. Bootstrap provides <a href="https://getbootstrap.com/docs/4.0/examples/">multiple examples</a> of standard website layouts. We will mimic the <a href="https://getbootstrap.com/docs/4.0/examples/pricing/">pricing page</a> nav bar.</p>

<p>If we look at the <a href="view-source:https://getbootstrap.com/docs/4.0/examples/pricing/">source code</a> for the page we can see exactly what HTML was used. As a first step we’ll just copy and paste the navbar code into our template right after the opening <code class="highlighter-rouge">&lt;body&gt;</code> tag.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- templates/base.html --&gt;</span>
<span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="c">&lt;!-- Required meta tags --&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1, shrink-to-fit=no"</span><span class="nt">&gt;</span>

    <span class="c">&lt;!-- Bootstrap CSS --&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"</span> <span class="na">integrity=</span><span class="s">"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;title&gt;</span>Social Messaging App<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom box-shadow"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h5</span> <span class="na">class=</span><span class="s">"my-0 mr-md-auto font-weight-normal"</span><span class="nt">&gt;</span>Company name<span class="nt">&lt;/h5&gt;</span>
      <span class="nt">&lt;nav</span> <span class="na">class=</span><span class="s">"my-2 my-md-0 mr-md-3"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"p-2 text-dark"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Features<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"p-2 text-dark"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Enterprise<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"p-2 text-dark"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Support<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"p-2 text-dark"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Pricing<span class="nt">&lt;/a&gt;</span>
      <span class="nt">&lt;/nav&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"btn btn-outline-primary"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Sign up<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    {% block content %}
    {% endblock %}

    <span class="c">&lt;!-- Optional JavaScript --&gt;</span>
    <span class="c">&lt;!-- jQuery first, then Popper.js, then Bootstrap JS --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://code.jquery.com/jquery-3.2.1.slim.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
</div>

<p>If you refresh the homepage at <a href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a> our new nav has magically appeared!</p>

<p><img src="https://djangoforbeginners.com/assets/images/book/pages-app/bootstrap-home.png" alt="Homepage with Bootstrap nav bar" /></p>

<p>Better yet if you shrink the size of your browser window Bootstrap automatically resizes and makes adjustments so it looks good on a mobile device, too.</p>

<p><img src="https://djangoforbeginners.com/assets/images/book/pages-app/bootstrap-home-mobile.png" alt="Mobile homepage with Bootstrap nav bar" /></p>

<p>You may have noticed we don’t have any side margins our webpage content. If we wrap <code class="highlighter-rouge">&lt;div class="container"&gt;</code> around our block content Bootstrap will automatically provide appropriate side margins.</p>

<p>Here’s the updated code.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- templates/base.html --&gt;</span>
...
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
  {% block content %}
  {% endblock %}
<span class="nt">&lt;/div&gt;</span>
...
</code></pre>
</div>

<p>Refresh the homepage and you’ll see it in action. You can even change the width of the web browser to see how the side margins change as the screen size increases and decreases.</p>

<p><img src="https://djangoforbeginners.com/assets/images/book/pages-app/homepage-with-container.png" alt="Bootstrap homepage with container" /></p>

<p>As the last step for our Bootstrap work we should update the links in the navbar so that they reflect our own project. We’ll call our website <code class="highlighter-rouge">Social</code>. We need a link to the About page. And we should show either a “Sign up” button if users are logged out or a “Log in” and “Log out” button if they are logged in.</p>

<p>Here’s the code.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- templates/base.html --&gt;</span>
...
<span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom box-shadow"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h5</span> <span class="na">class=</span><span class="s">"my-0 mr-md-auto font-weight-normal"</span><span class="nt">&gt;</span>Social<span class="nt">&lt;/h5&gt;</span>
    <span class="nt">&lt;nav</span> <span class="na">class=</span><span class="s">"my-2 my-md-0 mr-md-3"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"p-2 text-dark"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>About<span class="nt">&lt;/a&gt;</span>
    {% if user.is_authenticated %}
      <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"p-2 text-dark"</span> <span class="na">href=</span><span class="s">"{% url 'logout' %}"</span><span class="nt">&gt;</span>Log out<span class="nt">&lt;/a&gt;</span>
    {% else %}
      <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"p-2 text-dark"</span> <span class="na">href=</span><span class="s">"{% url 'login' %}"</span><span class="nt">&gt;</span>Log in<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/nav&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"btn btn-outline-primary"</span> <span class="na">href=</span><span class="s">"{% url 'signup' %}"</span><span class="nt">&gt;</span>Sign up<span class="nt">&lt;/a&gt;</span>
    {% endif %}
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
...
</code></pre>
</div>

<p>Note that we’re using the Django templating languages <a href="https://docs.djangoproject.com/en/2.0/ref/templates/builtins/#if">if/else</a> syntax for our logic here. If a user is logged out they see the “Log in” link and the “Sign up” button. If they are logged in they just see the “Log out” link.</p>

<p>Go ahead and play around with this functionality on the homepage at <a href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a>. Login and out several times with different user accounts to see it in action.</p>

<p><img src="https://djangoforbeginners.com/assets/images/book/pages-app/updated-nav-loggedin.png" alt="Updated navbar logged in" /></p>

<p><img src="https://djangoforbeginners.com/assets/images/book/pages-app/updated-nav-loggedout.png" alt="Updated navbar logged out" /></p>

<p>You can also see that our <a href="http://127.0.0.1:8000/users/login">http://127.0.0.1:8000/users/login</a> page looks better now, too.</p>

<p><img src="https://djangoforbeginners.com/assets/images/book/pages-app/bootstrap-login.png" alt="Bootstrap login" /></p>

<h2 id="signup-form">Signup Form</h2>
<p>Our signup page at <a href="http://127.0.0.1:8000/users/signup/">http://127.0.0.1:8000/users/signup/</a> has Bootstrap stylings but it still has somewhat distracting helper text. For example after “Username” it says “Required. 150 characters or fewer. Letters, digits and @/./+/-/_ only.”</p>

<p><img src="https://djangoforbeginners.com/assets/images/book/pages-app/bootstrap-signup.png" alt="Updated navbar logged out" /></p>

<p>Where did that text come from, right? Whenever something feels like “magic” in Django rest assured that it is decidedly not. Likely the code came from an internal piece of Django.</p>

<p>The fastest method I’ve found to figure out what’s happening under-the-hood in Django is to simply go to the <a href="https://github.com/django/django">Django source code on Github</a>, use the search bar and try to find the specific piece of text.</p>

<p>For example, if you do a search for “150 characters or fewer” you’ll find yourself on the <code class="highlighter-rouge">django/contrib/auth/models.py</code> page <a href="https://github.com/django/django/blob/4c599ece57fa009cf3615f09497f81bfa6a585a7/django/contrib/auth/models.py">located here</a> on line 301. The text comes as part of the <code class="highlighter-rouge">auth</code> app, on the <code class="highlighter-rouge">username</code> field for <code class="highlighter-rouge">AbstractUser</code>.</p>

<p>We have three options now:</p>

<ul>
  <li>override the existing <code class="highlighter-rouge">help_text</code></li>
  <li>hide the <code class="highlighter-rouge">help_text</code></li>
  <li>restyle the <code class="highlighter-rouge">help_text</code></li>
</ul>

<p>We’ll choose the third option since it’s a good way to introduce the excellent 3rd party package <a href="https://github.com/django-crispy-forms/django-crispy-forms">django-crispy-forms</a>. Working with forms is a challenge and <code class="highlighter-rouge">django-crispy-forms</code> makes it easier to write DRY code.</p>

<p>To start use <code class="highlighter-rouge">Pipenv</code> to install the package in our project.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>(msg) $ pipenv install django-crispy-forms
</code></pre>
</div>

<p>Add the new app to our <code class="highlighter-rouge">INSTALLED_APPS</code> list in the <code class="highlighter-rouge">settings.py</code> file. As the number of apps starts to grow, I found it helpful to distinguish between 3rd party packages and custom packages I’ve added myself. Here’s what the code looks like now.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># msg_project/settings.py</span>
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">'django.contrib.admin'</span><span class="p">,</span>
    <span class="s">'django.contrib.auth'</span><span class="p">,</span>
    <span class="s">'django.contrib.contenttypes'</span><span class="p">,</span>
    <span class="s">'django.contrib.sessions'</span><span class="p">,</span>
    <span class="s">'django.contrib.messages'</span><span class="p">,</span>
    <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
    <span class="s">'crispy_forms'</span><span class="p">,</span>
    <span class="s">'users'</span><span class="p">,</span>
    <span class="s">'pages'</span><span class="p">,</span>
<span class="p">]</span>
</code></pre>
</div>

<p>Since we’re using Bootstrap4 we should also add that config to our <code class="highlighter-rouge">settings.py</code> file. This goes on the bottom of the file.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># msg_project/settings.py</span>
<span class="n">CRISPY_TEMPLATE_PACK</span> <span class="o">=</span> <span class="s">'bootstrap4'</span>
</code></pre>
</div>

<p>Now in our <code class="highlighter-rouge">signup.html</code> template we can quickly use crispy forms. First we load <code class="highlighter-rouge">crispy_forms_tags</code> at the top and then swap out <code class="highlighter-rouge"><span class="p">{</span><span class="err">{</span><span class="w"> </span><span class="err">form.as_p</span><span class="w"> </span><span class="p">}</span><span class="err">}</span></code> for <code class="highlighter-rouge"><span class="p">{</span><span class="err">{</span><span class="w"> </span><span class="err">form|crispy</span><span class="w"> </span><span class="p">}</span><span class="err">}</span></code>.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- templates/signup.html --&gt;</span>
{% extends 'base.html' %}

{% load crispy_forms_tags %}

{% block title %}Sign Up{% endblock %}

{% block content %}
  <span class="nt">&lt;h2&gt;</span>Sign up<span class="nt">&lt;/h2&gt;</span>
  <span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    {% csrf_token %}
    {{ form|crispy }}
    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Sign up<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/form&gt;</span>
{% endblock %}
</code></pre>
</div>

<p>If you refresh the signup page we can see the new changes.</p>

<p><img src="https://djangoforbeginners.com/assets/images/book/pages-app/crispy-signup-page.png" alt="Crispy signup page" /></p>

<p>Much better. Although how about if our “Sign up” button was a little more inviting? Maybe make it green? Bootstrap has <a href="https://v4-alpha.getbootstrap.com/components/buttons/">all sorts of button styling options</a> we can choose from. Let’s use the “success” one which has a green background and white text.</p>

<p>Update the <code class="highlighter-rouge">signup.html</code> file on the line for the sign up button.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- templates/signup.html --&gt;</span>
...
<span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"btn btn-success"</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Sign up<span class="nt">&lt;/button&gt;</span>
...
</code></pre>
</div>

<p>Refresh the page and you can see our updated work.</p>

<p><img src="https://djangoforbeginners.com/assets/images/book/pages-app/green-signup-button.png" alt="Crispy signup page" /></p>

<h2 id="next-steps">Next Steps</h2>
<p>Our <em>messaging app</em> is starting to look pretty good. The last step of our user auth flow is to configure password change and reset. Here again Django has taken care of the heavy lifting for us so it requires a minimal amount of code on our part.</p>

<p>Continue on to <a href="chapter_10.html">Chapter 10: Password Change and Reset</a>.</p>

<p><br /></p>
<hr />

<p><br />

  </div>
</article>

<div id="disqus_thread"></div>

    </div>
  </main>
    <footer>
  <div class="container-flex">
    <div class="nav-wrapper">
      <div class="footer-left">
        Copyright &copy; 2018
      </div>
      <div class="footer-right">
        <a href="/">Home</a>
        <a href="/about/">About</a>
        <a href="http://eepurl.com/cRL-aP" target="_blank">Newsletter</a>
      </div>
    </div>
  </div>
</footer>

    <!-- Google Analytics -->

</body>
</html>
